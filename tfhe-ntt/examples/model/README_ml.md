# ML training (final_dataset.csv)

This folder contains scripts to generate/merge datasets and train simple ML classifiers.

## Dataset

- `dataset_output.csv` (base, 21k rows): created by the Rust generator.
- `rs_synthetic_7k.csv` (synthetic, 7k rows): generated by `ga_generate_rs_dataset.py`.
- `final_dataset.csv` (28k rows): concatenation of base + synthetic, created by `build_final_dataset.py`.

## Train models

The training script uses these features:

- `raw_N`, `padded_N`
- `frac_2i_nonzero`, `frac_2i1_nonzero`
- `frac_4i_nonzero`, `frac_4i1_nonzero`, `frac_4i2_nonzero`, `frac_4i3_nonzero`

Label:
- `output` ∈ {`r2`, `r4`, `rs`}

It trains:
- RandomForest
- XGBoost (if installed) otherwise falls back to HistGradientBoosting

### Install deps (recommended)

```bash
python3 -m pip install -U pip
python3 -m pip install pandas numpy scikit-learn xgboost
```

### Run

```bash
python3 tfhe-ntt/examples/model/train_models.py --csv tfhe-ntt/examples/model/final_dataset.csv
```

You’ll see train/val/test accuracy and a confusion matrix for the test split.
